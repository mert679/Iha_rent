{%load static%}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.4/css/jquery.dataTables.min.css">
</head>
<body>
    <nav class="navbar bg-body-tertiary">
        <div class="container-fluid">
          <a class="navbar-brand" href="{% url 'home-page'%}">IHA KİRALAMA</a> 
          <div style="display: flex;">
            {%if user.is_authenticated%}
            {% csrf_token %}
            <a class="nav-link" href="#" style="padding-right: 50px;"><strong>{{user.username}}</strong></a>
            <a class="nav-link" href="{% url 'logout'%}" style="padding-right: 50px;" id="logout"><strong>Çıkış</strong></a>
            {%else%}
            <a class="nav-link" href="{%url 'login' %}" style="padding-right: 50px;"><strong>Giriş</strong></a>
            <a class="nav-link" href="{%url 'register' %}" style="padding-right: 50px;"><strong>Kayıt ol</strong></a>
            {% endif %}
          </div>
        </div>
    </nav>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <div class="container mt-4">
        {% block body %}
        {% endblock %}
    </div>
    <script>
        // this function when user click to logout button it go back to welcome page
      $(document).ready(function() {
          $('#logout').click(function(e) {
              e.preventDefault(); 
  
              const csrfToken = $('input[name="csrfmiddlewaretoken"]').val();
  
              $.ajax({
                  url: '{% url "logout" %}',
                  type: 'POST',
                  headers: {
                      'X-CSRFToken': csrfToken
                  },
                  success: function(data) {
                      window.location.href = data.redirect_url; 
                  },
                  error: function(xhr) {
                      alert('Logout failed!');  
                  }
              });
          });
      });
  </script>

</body>
</html>